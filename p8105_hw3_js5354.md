P8105 HW3
================
Jiayi Shen
10/06/2018

Problem 1
=========

``` r
# install.packages("devtools")
devtools::install_github("p8105/p8105.datasets")
```

    ## Skipping install of 'p8105.datasets' from a github remote, the SHA1 (21f5ad1c) has not changed since last install.
    ##   Use `force = TRUE` to force installation

``` r
#load BRFSS data
library(p8105.datasets)
data(brfss_smart2010, package = "p8105.datasets")
```

``` r
brfss_smart2010 = brfss_smart2010 %>% 
  janitor::clean_names() %>% 
  filter(topic == "Overall Health") %>% 
  filter(response %in% c("Excellent", "Very good", "Good", "Fair", "Poor")) %>% 
  mutate(response = as_factor(response, levels = c("Excellent", "Very good", "Good", "Fair", "Poor"), ordered = TRUE))
```

``` r
# In 2002, what states were observed at 7 locations?
brfss_smart2010 %>% 
  filter(year == "2002") %>% 
  distinct(locationabbr, locationdesc) %>% 
  count(locationabbr) %>% 
  filter(n == 7)
```

    ## # A tibble: 3 x 2
    ##   locationabbr     n
    ##   <chr>        <int>
    ## 1 CT               7
    ## 2 FL               7
    ## 3 NC               7

``` r
# CT, FL and NC were 7 distinct "locationdesc" variables.
```

-   In 2002, CT, FL and NC were observed at 7 locations.

``` r
# create a relevant dataframe for spaghetti plot
spaghetti_df = 
brfss_smart2010 %>% 
  group_by(locationabbr, year) %>% 
  summarize(n_obs = sum(sample_size))

# a line plot that shows the number of obs in each state from 2002 to 2010. 
ggplot(spaghetti_df, aes(x = year, y = n_obs, color = locationabbr))+
  geom_line()+
  labs(y = "number of observations each year")
```

<img src="p8105_hw3_js5354_files/figure-markdown_github/spaghetti plot-1.png" width="90%" /> This line plot demonstrates the number of observations each year in each state. The time frame ranges from 2002 to 2010. One line represents the trend in he number of observations in one state. Different states are colored differently.

``` r
#First filter brfss data accordingly, and then calculate the mean and sd.
brfss_smart2010 %>% 
  filter(year %in% c("2002", "2006", "2010")) %>% 
  filter(locationabbr == "NY", response == "Excellent") %>% 
  group_by(year) %>% 
  summarize(mean_NY = mean(data_value), 
            sd_NY = sd(data_value)) %>% 
  knitr::kable(digits = 1)
```

|  year|  mean\_NY|  sd\_NY|
|-----:|---------:|-------:|
|  2002|      24.0|     4.5|
|  2006|      22.5|     4.0|
|  2010|      22.7|     3.6|

From 2002 to 2006, the average proportion of excellent response in all locations across NY dropped from 24.0% to 22.5%. And from 2006 to 2010, this proportion stayed relatively flat, around 22.5%. The variance between each location across the NY state decreased from 2002 to 2006 and then to 2010.

``` r
brfss_state_avg = 
brfss_smart2010 %>% 
  group_by(year, locationabbr, response) %>% 
  summarize(avg_prop = mean(data_value))

ggplot(brfss_state_avg, aes(x = year, y = avg_prop, color = locationabbr))+
  geom_line()+
  labs(y = "average proportion of each response in each state over time") +
  facet_grid(. ~ response)
```

    ## Warning: Removed 1 rows containing missing values (geom_path).

<img src="p8105_hw3_js5354_files/figure-markdown_github/state level average of each response-1.png" width="90%" />

*commenting* In general, the average proportion of responding either "excellent" or "very good" or "good" is greater than those of responding "fair" or "poor".

Problem 2
=========
